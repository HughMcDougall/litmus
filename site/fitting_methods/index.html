
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Hugh McDougall">
      
      
        <link rel="canonical" href="https://github.com/HughMcDougall/litmus/fitting_methods/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../lightcurve/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>fittingmethods - LITMUS</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4af4bdda.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../custom.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#litmusfitting_methods" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="LITMUS" class="md-header__button md-logo" aria-label="LITMUS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LITMUS
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              fittingmethods
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/HughMcDougall/litmus/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    HughMcDougall/litmus/
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="LITMUS" class="md-nav__button md-logo" aria-label="LITMUS" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    LITMUS
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/HughMcDougall/litmus/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    HughMcDougall/litmus/
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Code Docs
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Code Docs
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    fittingmethods
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    fittingmethods
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods" class="md-nav__link">
    <span class="md-ellipsis">
      fitting_methods
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure" class="md-nav__link">
    <span class="md-ellipsis">
      fitting_procedure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fitting_procedure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.set_config" class="md-nav__link">
    <span class="md-ellipsis">
      set_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.readyup" class="md-nav__link">
    <span class="md-ellipsis">
      readyup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.prefit" class="md-nav__link">
    <span class="md-ellipsis">
      prefit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.get_samples" class="md-nav__link">
    <span class="md-ellipsis">
      get_samples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.get_evidence" class="md-nav__link">
    <span class="md-ellipsis">
      get_evidence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.get_information" class="md-nav__link">
    <span class="md-ellipsis">
      get_information
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.get_peaks" class="md-nav__link">
    <span class="md-ellipsis">
      get_peaks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.ICCF" class="md-nav__link">
    <span class="md-ellipsis">
      ICCF
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.prior_sampling" class="md-nav__link">
    <span class="md-ellipsis">
      prior_sampling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.nested_sampling" class="md-nav__link">
    <span class="md-ellipsis">
      nested_sampling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="nested_sampling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.nested_sampling.get_evidence" class="md-nav__link">
    <span class="md-ellipsis">
      get_evidence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.nested_sampling.get_information" class="md-nav__link">
    <span class="md-ellipsis">
      get_information
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.hessian_scan" class="md-nav__link">
    <span class="md-ellipsis">
      hessian_scan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hessian_scan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.hessian_scan.estimate_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.hessian_scan.make_grid" class="md-nav__link">
    <span class="md-ellipsis">
      make_grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.hessian_scan.diagnostics" class="md-nav__link">
    <span class="md-ellipsis">
      diagnostics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.SVI_scan" class="md-nav__link">
    <span class="md-ellipsis">
      SVI_scan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.JAVELIKE" class="md-nav__link">
    <span class="md-ellipsis">
      JAVELIKE
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lightcurve/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lightcurve
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../litmusclass/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    litmusclass
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../logging/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logging
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../mocks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    mocks
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../models/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    models
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../lin_scatter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    lin_scatter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../GP_working/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    GP_working
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../_utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utilities
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods" class="md-nav__link">
    <span class="md-ellipsis">
      fitting_methods
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure" class="md-nav__link">
    <span class="md-ellipsis">
      fitting_procedure
    </span>
  </a>
  
    <nav class="md-nav" aria-label="fitting_procedure">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.reset" class="md-nav__link">
    <span class="md-ellipsis">
      reset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.set_config" class="md-nav__link">
    <span class="md-ellipsis">
      set_config
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.readyup" class="md-nav__link">
    <span class="md-ellipsis">
      readyup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.prefit" class="md-nav__link">
    <span class="md-ellipsis">
      prefit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.fit" class="md-nav__link">
    <span class="md-ellipsis">
      fit
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.get_samples" class="md-nav__link">
    <span class="md-ellipsis">
      get_samples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.get_evidence" class="md-nav__link">
    <span class="md-ellipsis">
      get_evidence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.get_information" class="md-nav__link">
    <span class="md-ellipsis">
      get_information
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.fitting_procedure.get_peaks" class="md-nav__link">
    <span class="md-ellipsis">
      get_peaks
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.ICCF" class="md-nav__link">
    <span class="md-ellipsis">
      ICCF
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.prior_sampling" class="md-nav__link">
    <span class="md-ellipsis">
      prior_sampling
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.nested_sampling" class="md-nav__link">
    <span class="md-ellipsis">
      nested_sampling
    </span>
  </a>
  
    <nav class="md-nav" aria-label="nested_sampling">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.nested_sampling.get_evidence" class="md-nav__link">
    <span class="md-ellipsis">
      get_evidence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.nested_sampling.get_information" class="md-nav__link">
    <span class="md-ellipsis">
      get_information
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.hessian_scan" class="md-nav__link">
    <span class="md-ellipsis">
      hessian_scan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="hessian_scan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.hessian_scan.estimate_MAP" class="md-nav__link">
    <span class="md-ellipsis">
      estimate_MAP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.hessian_scan.make_grid" class="md-nav__link">
    <span class="md-ellipsis">
      make_grid
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#litmus.fitting_methods.hessian_scan.diagnostics" class="md-nav__link">
    <span class="md-ellipsis">
      diagnostics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.SVI_scan" class="md-nav__link">
    <span class="md-ellipsis">
      SVI_scan
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#litmus.fitting_methods.JAVELIKE" class="md-nav__link">
    <span class="md-ellipsis">
      JAVELIKE
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="litmusfitting_methods"><code>litmus.fitting_methods</code></h1>


<div class="doc doc-object doc-module">



<a id="litmus.fitting_methods"></a>
    <div class="doc doc-contents first">

        <p>Contains fitting procedures to be executed by the litmus class object</p>
<p>HM 24</p>









  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h4 id="litmus.fitting_methods.fitting_procedure" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">fitting_procedure</span><span class="p">(</span><span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span> <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="              logger(out_stream=sys.stdout, err_stream=sys.stderr, verbose: bool = True, debug: bool = False) (litmus.logging.logger)" href="../logging/#litmus.logging.logger">logger</a></code></p>


        <p>Generic class for lag fitting procedures. Contains parent methods for setting properties</p>







                  <details class="quote">
                    <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span>
             <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span>
             <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>
             <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="n">debug</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
             <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>

    <span class="n">logger</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">out_stream</span><span class="o">=</span><span class="n">out_stream</span><span class="p">,</span>
                    <span class="n">err_stream</span><span class="o">=</span><span class="n">err_stream</span><span class="p">,</span>
                    <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                    <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">,</span>
                    <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_default_params&quot;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span> <span class="o">=</span> <span class="n">stat_model</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Base Fitting Procedure&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">is_ready</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_prefit</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">has_run</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">fitting_params</span> <span class="o">=</span> <span class="p">{}</span> <span class="o">|</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_config</span><span class="p">(</span><span class="o">**</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">|</span> <span class="n">fit_params</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">seed</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">randint</span><span class="p">()</span> <span class="k">if</span> <span class="s2">&quot;seed&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">fit_params</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">fit_params</span><span class="p">[</span><span class="s1">&#39;seed&#39;</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.fitting_procedure.reset" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">reset</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Clears all memory and resets params to defaults</p>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">reset</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Clears all memory and resets params to defaults</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_config</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">has_run</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ready</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span>

    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.fitting_procedure.set_config" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">set_config</span><span class="p">(</span><span class="o">**</span><span class="n">fit_params</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Configure fitting parameters for fitting_method() object
Accepts any parameters present with a name in fitting_method.fitting_params
Unlisted parameters will be ignored.</p>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">set_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Configure fitting parameters for fitting_method() object</span>
<span class="sd">    Accepts any parameters present with a name in fitting_method.fitting_params</span>
<span class="sd">    Unlisted parameters will be ignored.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Doing config with keys&quot;</span><span class="p">,</span> <span class="n">fit_params</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>

    <span class="n">badkeys</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">fit_params</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">fit_params</span><span class="o">.</span><span class="n">keys</span><span class="p">(),</span> <span class="n">fit_params</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">badkeys</span><span class="p">:</span> <span class="k">continue</span>

        <span class="c1"># If something&#39;s changed, flag as having not run</span>
        <span class="n">currval</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_run</span> <span class="ow">and</span> <span class="n">val</span> <span class="o">!=</span> <span class="n">currval</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_run</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        <span class="c1"># self.fitting_params |= {key: val}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> set attr&quot;</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">out_stream</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">badkeys</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_err</span><span class="p">(</span><span class="s2">&quot;Tried to configure bad keys:&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">badkeys</span><span class="p">,</span> <span class="n">delim</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.fitting_procedure.readyup" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">readyup</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Performs pre-fit preparation calcs. Should only be called if not self.is_ready()</p>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">readyup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Performs pre-fit preparation calcs. Should only be called if not self.is_ready()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">is_ready</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.fitting_procedure.prefit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">prefit</span><span class="p">(</span><span class="n">lc_1</span><span class="p">:</span> <span class="n">lightcurve</span><span class="p">,</span> <span class="n">lc_2</span><span class="p">:</span> <span class="n">lightcurve</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Fit lags</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lc_1</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="lightcurve (litmus.lightcurve.lightcurve)" href="../lightcurve/#litmus.lightcurve">lightcurve</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lightcurve 1 (Main)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lc_2</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="lightcurve (litmus.lightcurve.lightcurve)" href="../lightcurve/#litmus.lightcurve">lightcurve</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lightcurve 2 (Response)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A random seed for feeding to the fitting process. If none, will select randomly</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">prefit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lc_1</span><span class="p">:</span> <span class="n">lightcurve</span><span class="p">,</span> <span class="n">lc_2</span><span class="p">:</span> <span class="n">lightcurve</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fit lags</span>
<span class="sd">    :param lc_1: Lightcurve 1 (Main)</span>
<span class="sd">    :param lc_2: Lightcurve 2 (Response)</span>
<span class="sd">    :param seed: A random seed for feeding to the fitting process. If none, will select randomly</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">has_prefit</span> <span class="o">=</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.fitting_procedure.fit" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">fit</span><span class="p">(</span><span class="n">lc_1</span><span class="p">:</span> <span class="n">lightcurve</span><span class="p">,</span> <span class="n">lc_2</span><span class="p">:</span> <span class="n">lightcurve</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Fit lags</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lc_1</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="lightcurve (litmus.lightcurve.lightcurve)" href="../lightcurve/#litmus.lightcurve">lightcurve</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lightcurve 1 (Main)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lc_2</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="lightcurve (litmus.lightcurve.lightcurve)" href="../lightcurve/#litmus.lightcurve">lightcurve</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lightcurve 2 (Response)</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A random seed for feeding to the fitting process. If none, will select randomly</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lc_1</span><span class="p">:</span> <span class="n">lightcurve</span><span class="p">,</span> <span class="n">lc_2</span><span class="p">:</span> <span class="n">lightcurve</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fit lags</span>
<span class="sd">    :param lc_1: Lightcurve 1 (Main)</span>
<span class="sd">    :param lc_2: Lightcurve 2 (Response)</span>
<span class="sd">    :param seed: A random seed for feeding to the fitting process. If none, will select randomly</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Sanity checks inherited by all subclasses</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ready</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">readyup</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">randint</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">randint</span><span class="p">()</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span>

    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">lc_to_data</span><span class="p">(</span><span class="n">lc_1</span><span class="p">,</span> <span class="n">lc_2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_data</span> <span class="o">=</span> <span class="n">data</span>

    <span class="c1"># An error message raised if this fitting procedure doesn&#39;t have .fit()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">fit</span> <span class="o">==</span> <span class="n">fitting_procedure</span><span class="o">.</span><span class="n">fit</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_err</span><span class="p">(</span><span class="s2">&quot;Fitting </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> method does not have method .fit() implemented&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    <span class="k">return</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.fitting_procedure.get_samples" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_samples</span><span class="p">(</span><span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">importance_sampling</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="nb">str</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">]}</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Returns MCMC-like posterior samples</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>N</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples to return. If None, return all</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random seed for any stochastic elements</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>importance_sampling</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If true, will weight the results by</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code>{<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>: [<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]}</code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_samples</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">N</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">importance_sampling</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">{</span><span class="nb">str</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">]}:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns MCMC-like posterior samples</span>
<span class="sd">    :param N: Number of samples to return. If None, return all</span>
<span class="sd">    :param seed: Random seed for any stochastic elements</span>
<span class="sd">    :param importance_sampling: If true, will weight the results by</span>
<span class="sd">    :return:</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ready</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">readyup</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">randint</span><span class="p">()</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">fit</span> <span class="o">==</span> <span class="n">fitting_procedure</span><span class="o">.</span><span class="n">fit</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_err</span><span class="p">(</span><span class="s2">&quot;Fitting </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> method does not have method .get_samples() implemented&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.fitting_procedure.get_evidence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_evidence</span><span class="p">(</span><span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Returns the estimated evidence for the fit model.
if return_type = 'linear', returns as array-like [Z,-dZ-,dZ+]
if return_type = 'log', returns as array-like [logZ,-dlogZ-,dlogZ+]</p>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_evidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the estimated evidence for the fit model.</span>
<span class="sd">    if return_type = &#39;linear&#39;, returns as array-like [Z,-dZ-,dZ+]</span>
<span class="sd">    if return_type = &#39;log&#39;, returns as array-like [logZ,-dlogZ-,dlogZ+]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">assert</span> <span class="n">return_type</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">],</span> <span class="s2">&quot;Return type must be &#39;linear&#39; or &#39;log&#39;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ready</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">readyup</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">has_run</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">msg_err</span><span class="p">(</span><span class="s2">&quot;Warning! Tried to call get_evidence without running first!&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">randint</span><span class="p">()</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">get_evidence</span> <span class="o">==</span> <span class="n">fitting_procedure</span><span class="o">.</span><span class="n">get_evidence</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_err</span><span class="p">(</span><span class="s2">&quot;Fitting </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> method does not have method .get_evidence() implemented&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.fitting_procedure.get_information" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_information</span><span class="p">(</span><span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Returns an estimate of the information (KL divergence relative to prior). Returns as array-like [I,dI-,dI+]</p>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns an estimate of the information (KL divergence relative to prior). Returns as array-like [I,dI-,dI+]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ready</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">readyup</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">randint</span><span class="p">()</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">get_information</span> <span class="o">==</span> <span class="n">fitting_procedure</span><span class="o">.</span><span class="n">get_information</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_err</span><span class="p">(</span><span class="s2">&quot;Fitting </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> method does not have method .get_information() implemented&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.fitting_procedure.get_peaks" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_peaks</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Returns the maximum posterior position in parameter space</p>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_peaks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the maximum posterior position in parameter space</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ready</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">readyup</span><span class="p">()</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span> <span class="o">=</span> <span class="n">seed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">randint</span><span class="p">()</span>
    <span class="n">seed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tempseed</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="n">get_peaks</span> <span class="o">==</span> <span class="n">fitting_procedure</span><span class="o">.</span><span class="n">get_peaks</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_err</span><span class="p">(</span><span class="s2">&quot;Fitting </span><span class="se">\&quot;</span><span class="si">%s</span><span class="se">\&quot;</span><span class="s2"> method does not have method .get_peaks() implemented&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">{},</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([])</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="litmus.fitting_methods.ICCF" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">ICCF</span><span class="p">(</span><span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span> <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="              fitting_procedure(stat_model: stats_model, out_stream=sys.stdout, err_stream=sys.stderr, verbose=True, debug=True, **fit_params) (litmus.fitting_methods.fitting_procedure)" href="#litmus.fitting_methods.fitting_procedure">fitting_procedure</a></code></p>


        <p>Fit lags using interpolated cross correlation function in the style of pyCCF.
Note that this is not a Bayesian fitter and gives only approximate measures of the lag
todo
    - Add p value, false positive and evidence estimates (?)</p>







                  <details class="quote">
                    <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span>
             <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>
             <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>

    <span class="n">args_in</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="nb">locals</span><span class="p">(),</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">}</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;__class__&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_default_params&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">|=</span> <span class="p">{</span>
        <span class="s1">&#39;Nboot&#39;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
        <span class="s1">&#39;Nterp&#39;</span><span class="p">:</span> <span class="mi">2014</span><span class="p">,</span>
        <span class="s1">&#39;Nlags&#39;</span><span class="p">:</span> <span class="mi">512</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">args_in</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;ICCF Fitting Procedure&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nterp</span><span class="p">)</span>

    <span class="c1"># -----------------------------------</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nboot</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">correl_curve</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nterp</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lag_mean</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">lag_err</span> <span class="o">=</span> <span class="mf">0.0</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="litmus.fitting_methods.prior_sampling" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">prior_sampling</span><span class="p">(</span><span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span> <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="              fitting_procedure(stat_model: stats_model, out_stream=sys.stdout, err_stream=sys.stderr, verbose=True, debug=True, **fit_params) (litmus.fitting_methods.fitting_procedure)" href="#litmus.fitting_methods.fitting_procedure">fitting_procedure</a></code></p>


        <p>Randomly samples from the prior and weights with importance sampling.
The crudest available sampler. For test purposes only, not suggested for actual use.</p>







                  <details class="quote">
                    <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span>
             <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>
             <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>

    <span class="c1"># ------------------------------------</span>
    <span class="n">args_in</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="nb">locals</span><span class="p">(),</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">}</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;__class__&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_default_params&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">|=</span> <span class="p">{</span>
        <span class="s1">&#39;Nsamples&#39;</span><span class="p">:</span> <span class="mi">4096</span>
    <span class="p">}</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">args_in</span><span class="p">)</span>
    <span class="c1"># ------------------------------------</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Prior Sampling Fitting Procedure&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">samples</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsamples</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_likes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsamples</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nsamples</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="litmus.fitting_methods.nested_sampling" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">nested_sampling</span><span class="p">(</span><span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span> <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="              fitting_procedure(stat_model: stats_model, out_stream=sys.stdout, err_stream=sys.stderr, verbose=True, debug=True, **fit_params) (litmus.fitting_methods.fitting_procedure)" href="#litmus.fitting_methods.fitting_procedure">fitting_procedure</a></code></p>


        <p>Fits the Bayesian model with Nested Sampling by using JAXNS. Highly accurate evidence / posterior distributions,
but can be slow for models with more than a few parameters. Use only if hessian_scan and SVI_scan fail.</p>







                  <details class="quote">
                    <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span>
             <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>
             <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>

    <span class="n">args_in</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="nb">locals</span><span class="p">(),</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">}</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;__class__&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_default_params&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">|=</span> <span class="p">{</span>
        <span class="s1">&#39;num_live_points&#39;</span><span class="p">:</span> <span class="mi">500</span><span class="p">,</span>
        <span class="s1">&#39;max_samples&#39;</span><span class="p">:</span> <span class="mi">10_000</span><span class="p">,</span>
        <span class="s1">&#39;num_parallel_samplers&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;evidence_uncert&#39;</span><span class="p">:</span> <span class="mf">1E-3</span><span class="p">,</span>
        <span class="s1">&#39;live_evidence_frac&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mf">1e-3</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">args_in</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Nested Sampling Fitting Procedure&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sampler</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_jaxnsmodel</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_jaxnsresults</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_jaxnstermination</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_jaxnsresults</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">logevidence</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">priorvolume</span> <span class="o">=</span> <span class="mf">0.0</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.nested_sampling.get_evidence" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_evidence</span><span class="p">(</span><span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Returns the -1, 0 and +1 sigma values for model evidence from nested sampling.
This represents an estimate of numerical uncertainty</p>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_evidence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_type</span><span class="o">=</span><span class="s1">&#39;linear&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Returns the -1, 0 and +1 sigma values for model evidence from nested sampling.</span>
<span class="sd">    This represents an estimate of numerical uncertainty</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">randint</span><span class="p">()</span>

    <span class="n">l</span><span class="p">,</span> <span class="n">l_e</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jaxnsresults</span><span class="o">.</span><span class="n">log_Z_mean</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jaxnsresults</span><span class="o">.</span><span class="n">log_Z_uncert</span>

    <span class="k">if</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>

        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">([</span>
            <span class="n">l</span><span class="p">,</span>
            <span class="n">l</span> <span class="o">-</span> <span class="n">l_e</span><span class="p">,</span>
            <span class="n">l</span> <span class="o">+</span> <span class="n">l_e</span>
        <span class="p">])</span>

        <span class="n">out</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
    <span class="k">elif</span> <span class="n">return_type</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">l</span><span class="p">,</span> <span class="o">-</span><span class="n">l_e</span><span class="p">,</span> <span class="n">l_e</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">out</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.nested_sampling.get_information" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">get_information</span><span class="p">(</span><span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Use the Nested Sampling shells to estimate the model information relative to prior</p>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_information</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Use the Nested Sampling shells to estimate the model information relative to prior</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># todo - this is outmoded</span>

    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">seed</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">randint</span><span class="p">()</span>

    <span class="n">NS</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampler</span>
    <span class="n">samples</span><span class="p">,</span> <span class="n">logweights</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jaxnsresults</span><span class="o">.</span><span class="n">samples</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jaxnsresults</span><span class="o">.</span><span class="n">log_dp_mean</span>

    <span class="n">weights</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">logweights</span><span class="p">)</span>
    <span class="n">weights</span> <span class="o">/=</span> <span class="n">weights</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

    <span class="n">log_density</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_jaxnsresults</span><span class="o">.</span><span class="n">log_posterior_density</span>
    <span class="n">prior_values</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">log_prior</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span>

    <span class="n">info</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">log_density</span> <span class="o">-</span> <span class="n">prior_values</span><span class="p">)</span> <span class="o">*</span> <span class="n">weights</span><span class="p">)</span>

    <span class="n">partial_info</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">((</span><span class="n">log_density</span> <span class="o">-</span> <span class="n">prior_values</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">log_density</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="n">weights</span><span class="p">)</span>
    <span class="n">uncert</span> <span class="o">=</span> <span class="n">partial_info</span><span class="o">.</span><span class="n">std</span><span class="p">()</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">log_density</span><span class="p">))</span>

    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">info</span><span class="p">,</span> <span class="n">uncert</span><span class="p">,</span> <span class="n">uncert</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="litmus.fitting_methods.hessian_scan" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">hessian_scan</span><span class="p">(</span><span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span> <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="              fitting_procedure(stat_model: stats_model, out_stream=sys.stdout, err_stream=sys.stderr, verbose=True, debug=True, **fit_params) (litmus.fitting_methods.fitting_procedure)" href="#litmus.fitting_methods.fitting_procedure">fitting_procedure</a></code></p>








                  <details class="quote">
                    <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span>
             <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>
             <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>
    <span class="n">args_in</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="nb">locals</span><span class="p">(),</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">}</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;__class__&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_default_params&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">|=</span> <span class="p">{</span>
        <span class="s1">&#39;Nlags&#39;</span><span class="p">:</span> <span class="mi">64</span><span class="p">,</span>
        <span class="s1">&#39;opt_tol&#39;</span><span class="p">:</span> <span class="mf">1E-2</span><span class="p">,</span>
        <span class="s1">&#39;opt_tol_init&#39;</span><span class="p">:</span> <span class="mf">1E-4</span><span class="p">,</span>
        <span class="s1">&#39;step_size&#39;</span><span class="p">:</span> <span class="mf">0.001</span><span class="p">,</span>
        <span class="s1">&#39;constrained_domain&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
        <span class="s1">&#39;max_opt_eval&#39;</span><span class="p">:</span> <span class="mi">1_000</span><span class="p">,</span>
        <span class="s1">&#39;max_opt_eval_init&#39;</span><span class="p">:</span> <span class="mi">5_000</span><span class="p">,</span>
        <span class="s1">&#39;LL_threshold&#39;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">,</span>
        <span class="s1">&#39;init_samples&#39;</span><span class="p">:</span> <span class="mi">5_000</span><span class="p">,</span>
        <span class="s1">&#39;grid_bunching&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
        <span class="s1">&#39;grid_depth&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;grid_Nterp&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">,</span>
        <span class="s1">&#39;grid_relaxation&#39;</span><span class="p">:</span> <span class="mf">0.1</span><span class="p">,</span>  <span class="c1"># deprecated, remove</span>
        <span class="s1">&#39;grid_firstdepth&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="s1">&#39;reverse&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;split_lags&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span>
        <span class="s1">&#39;optimizer_args_init&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;optimizer_args&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;seed_params&#39;</span><span class="p">:</span> <span class="p">{},</span>
        <span class="s1">&#39;precondition&#39;</span><span class="p">:</span> <span class="s1">&#39;diag&#39;</span><span class="p">,</span>
        <span class="s1">&#39;interp_scale&#39;</span><span class="p">:</span> <span class="s1">&#39;log&#39;</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_allowable_interpscales</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span> <span class="s1">&#39;log&#39;</span><span class="p">]</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">args_in</span><span class="p">)</span>

    <span class="c1"># -----------------------------------</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Hessian Scan Fitting Procedure&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">:</span> <span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nlags</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">converged</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lags</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">scan_peaks</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span><span class="kc">None</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_evidences</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_evidences_uncert</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">diagnostic_hessians</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">diagnostic_densities</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">diagnostic_grads</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">diagnostic_ints</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">diagnostic_tgrads</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">params_toscan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">free_params</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;lag&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_toscan</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">params_toscan</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s1">&#39;lag&#39;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">precon_matrix</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params_toscan</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">solver</span><span class="p">:</span> <span class="n">jaxopt</span><span class="o">.</span><span class="n">BFGS</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">estmap_params</span> <span class="o">=</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.hessian_scan.estimate_MAP" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">estimate_MAP</span><span class="p">(</span><span class="n">lc_1</span><span class="p">:</span> <span class="n">lightcurve</span><span class="p">,</span> <span class="n">lc_2</span><span class="p">:</span> <span class="n">lightcurve</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>lc_1</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="lightcurve (litmus.lightcurve.lightcurve)" href="../lightcurve/#litmus.lightcurve">lightcurve</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>lc_2</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="lightcurve (litmus.lightcurve.lightcurve)" href="../lightcurve/#litmus.lightcurve">lightcurve</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span>
<span class="normal">905</span>
<span class="normal">906</span>
<span class="normal">907</span>
<span class="normal">908</span>
<span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">estimate_MAP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lc_1</span><span class="p">:</span> <span class="n">lightcurve</span><span class="p">,</span> <span class="n">lc_2</span><span class="p">:</span> <span class="n">lightcurve</span><span class="p">,</span> <span class="n">seed</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    :param lc_1:</span>
<span class="sd">    :param lc_2:</span>
<span class="sd">    :param seed:</span>
<span class="sd">    :return:</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">lc_to_data</span><span class="p">(</span><span class="n">lc_1</span><span class="p">,</span> <span class="n">lc_2</span><span class="p">)</span>

    <span class="c1"># ----------------------------------</span>
    <span class="c1"># Find seed for optimization if not supplies</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">free_params</span><span class="p">()</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed_params</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="n">seed_params</span><span class="p">,</span> <span class="n">ll_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">find_seed</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">guesses</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">init_samples</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seed_params</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span><span class="s2">&quot;Beginning scan at constrained-space position:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">seed_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">: </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">it</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span>
            <span class="s2">&quot;Log-Density for this is: </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ll_start</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">seed_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">seed_params</span>
        <span class="n">ll_start</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">log_density</span><span class="p">(</span><span class="n">seed_params</span><span class="p">,</span>
                                               <span class="n">data</span><span class="o">=</span><span class="n">data</span>
                                               <span class="p">)</span>

    <span class="c1"># ----------------------------------</span>
    <span class="c1"># SCANNING FOR OPT</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span><span class="s2">&quot;Moving non-lag params to new location...&quot;</span><span class="p">)</span>
    <span class="n">estmap_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">start_params</span><span class="o">=</span><span class="n">seed_params</span><span class="p">,</span>
                                         <span class="n">optim_params</span><span class="o">=</span><span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">free_params</span><span class="p">()</span> <span class="k">if</span>
                                                       <span class="n">key</span> <span class="o">!=</span> <span class="s1">&#39;lag&#39;</span><span class="p">],</span>
                                         <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                         <span class="n">optim_kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer_args_init</span><span class="p">,</span>
                                         <span class="n">precondition</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">precondition</span>
                                         <span class="p">)</span>
    <span class="n">ll_firstscan</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">log_density</span><span class="p">(</span><span class="n">estmap_params</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;lag&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">free_params</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span><span class="s2">&quot;Optimizer settled at new fit:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">estmap_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">: </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">it</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span>
            <span class="s2">&quot;Log-Density for this is: </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ll_firstscan</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span><span class="s2">&quot;Finding a good lag...&quot;</span><span class="p">)</span>
        <span class="n">test_lags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">prior_sample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">init_samples</span><span class="p">)[</span><span class="s1">&#39;lag&#39;</span><span class="p">]</span>
        <span class="n">test_samples</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">dict_extend</span><span class="p">(</span><span class="n">estmap_params</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;lag&#39;</span><span class="p">:</span> <span class="n">test_lags</span><span class="p">})</span>
        <span class="n">ll_test</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">log_density</span><span class="p">(</span><span class="n">test_samples</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="n">bestlag</span> <span class="o">=</span> <span class="n">test_lags</span><span class="p">[</span><span class="n">ll_test</span><span class="o">.</span><span class="n">argmax</span><span class="p">()]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span><span class="s2">&quot;Grid finds good lag at </span><span class="si">%.2f</span><span class="s2">:&quot;</span> <span class="o">%</span> <span class="n">bestlag</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span>
            <span class="s2">&quot;Log-Density for this is: </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ll_test</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">ll_test</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">ll_firstscan</span><span class="p">:</span>
            <span class="n">bestlag</span> <span class="o">=</span> <span class="n">bestlag</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bestlag</span> <span class="o">=</span> <span class="n">estmap_params</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">]</span>

        <span class="n">estmap_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">scan</span><span class="p">(</span><span class="n">start_params</span><span class="o">=</span><span class="n">estmap_params</span> <span class="o">|</span> <span class="p">{</span><span class="s1">&#39;lag&#39;</span><span class="p">:</span> <span class="n">bestlag</span><span class="p">},</span>
                                             <span class="n">optim_params</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">],</span>
                                             <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                                             <span class="n">optim_kwargs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">optimizer_args_init</span><span class="p">,</span>
                                             <span class="n">precondition</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">precondition</span>
                                             <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span><span class="s2">&quot;Lag-only opt settled at new lag </span><span class="si">%.2f</span><span class="s2">...&quot;</span> <span class="o">%</span> <span class="n">estmap_params</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">])</span>

    <span class="n">ll_end</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">log_density</span><span class="p">(</span><span class="n">estmap_params</span><span class="p">,</span>
                                         <span class="n">data</span><span class="o">=</span><span class="n">data</span>
                                         <span class="p">)</span>

    <span class="c1"># ----------------------------------</span>
    <span class="c1"># CHECKING OUTPUTS</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span><span class="s2">&quot;Optimizer settled at new fit:&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">estmap_params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1"> </span><span class="si">%s</span><span class="s1">: </span><span class="se">\t</span><span class="s1"> </span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">it</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">it</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">msg_run</span><span class="p">(</span>
        <span class="s2">&quot;Log-Density for this is: </span><span class="si">%.2f</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">ll_end</span>
    <span class="p">)</span>

    <span class="c1"># ----------------------------------</span>
    <span class="c1"># CHECKING OUTPUTS</span>

    <span class="k">if</span> <span class="n">ll_end</span> <span class="o">&lt;</span> <span class="n">ll_start</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">msg_err</span><span class="p">(</span><span class="s2">&quot;Warning! Optimization seems to have diverged. Defaulting to seed params. </span><span class="se">\n</span><span class="s2">&quot;</span>
                     <span class="s2">&quot;Please consider running with different optim_init inputs&quot;</span><span class="p">)</span>
        <span class="n">estmap_params</span> <span class="o">=</span> <span class="n">seed_params</span>
    <span class="k">return</span> <span class="n">estmap_params</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.hessian_scan.make_grid" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">make_grid</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">seed_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interp_scale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>data</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>seed_params</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>interp_scale</code>
            </td>
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
            <td>
                  <code>&#39;log&#39;</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">make_grid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">seed_params</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interp_scale</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :param data:</span>
<span class="sd">    :param seed_params:</span>
<span class="sd">    :param interp_scale:</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># todo - reformat this and the make_grid for better consistency in drawing from estmap and seed params</span>

    <span class="k">assert</span> <span class="n">interp_scale</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;log&#39;</span><span class="p">,</span> <span class="s1">&#39;linear&#39;</span><span class="p">],</span> <span class="s2">&quot;Interp scale was </span><span class="si">%s</span><span class="s2">, must be in &#39;log&#39; or &#39;linear&#39;&quot;</span> <span class="o">%</span> <span class="n">interp_scale</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_ready</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">readyup</span><span class="p">()</span>

    <span class="k">if</span> <span class="s1">&#39;lag&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">fixed_params</span><span class="p">():</span>
        <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">prior_ranges</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">])])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Nlags</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readyup</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">lags</span>

    <span class="c1"># If no seed parameters specified, use stored</span>
    <span class="k">if</span> <span class="n">seed_params</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">seed_params</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estmap_params</span>

    <span class="c1"># If these params are incomplete, use find_seed to complete them</span>
    <span class="k">if</span> <span class="n">seed_params</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">paramnames</span><span class="p">():</span>
        <span class="n">seed_params</span><span class="p">,</span> <span class="n">llstart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">find_seed</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">guesses</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">init_samples</span><span class="p">,</span> <span class="n">fixed</span><span class="o">=</span><span class="n">seed_params</span><span class="p">)</span>

    <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">prior_ranges</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">],</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">Nlags</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_firstdepth</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span>
                       <span class="n">endpoint</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="n">lag_terp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">prior_ranges</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_Nterp</span><span class="p">)</span>

    <span class="n">log_density_all</span><span class="p">,</span> <span class="n">lags_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,)),</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grid_depth</span><span class="p">):</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">_utils</span><span class="o">.</span><span class="n">dict_extend</span><span class="p">(</span><span class="n">seed_params</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;lag&#39;</span><span class="p">:</span> <span class="n">lags</span><span class="p">})</span>
        <span class="n">log_density_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">log_density_all</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">stat_model</span><span class="o">.</span><span class="n">log_density</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">data</span><span class="p">)])</span>
        <span class="n">lags_all</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">lags_all</span><span class="p">,</span> <span class="n">lags</span><span class="p">])</span>
        <span class="n">I</span> <span class="o">=</span> <span class="n">lags_all</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
        <span class="n">log_density_all</span><span class="p">,</span> <span class="n">lags_all</span> <span class="o">=</span> <span class="n">log_density_all</span><span class="p">[</span><span class="n">I</span><span class="p">],</span> <span class="n">lags_all</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">interp_scale</span> <span class="o">==</span> <span class="s1">&#39;linear&#39;</span><span class="p">:</span>

            <span class="n">density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_density_all</span> <span class="o">-</span> <span class="n">log_density_all</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

            <span class="c1"># Linearly interpolate the density profile</span>
            <span class="n">density_terp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">lag_terp</span><span class="p">,</span> <span class="n">lags_all</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">density_terp</span> <span class="o">/=</span> <span class="n">density_terp</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>


        <span class="k">elif</span> <span class="n">interp_scale</span> <span class="o">==</span> <span class="s1">&#39;log&#39;</span><span class="p">:</span>

            <span class="n">density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_density_all</span> <span class="o">-</span> <span class="n">log_density_all</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

            <span class="c1"># Linearly interpolate the density profile</span>
            <span class="n">log_density_terp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">lag_terp</span><span class="p">,</span> <span class="n">log_density_all</span> <span class="o">-</span> <span class="n">log_density_all</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">density</span><span class="p">,</span>
                                         <span class="n">left</span><span class="o">=</span><span class="n">log_density_all</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">right</span><span class="o">=</span><span class="n">log_density_all</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">density_terp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">log_density_terp</span><span class="p">)</span>
            <span class="n">density_terp</span> <span class="o">/=</span> <span class="n">density_terp</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

        <span class="n">gets</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_Nterp</span><span class="p">)</span>
        <span class="n">percentiles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">density_terp</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_bunching</span> <span class="o">+</span> <span class="n">gets</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid_bunching</span><span class="p">)</span>
        <span class="n">percentiles</span> <span class="o">/=</span> <span class="n">percentiles</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>

        <span class="n">lags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Nlags</span><span class="p">),</span> <span class="n">percentiles</span><span class="p">,</span> <span class="n">lag_terp</span><span class="p">,</span>
                         <span class="n">left</span><span class="o">=</span><span class="n">lag_terp</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span>
                         <span class="n">right</span><span class="o">=</span><span class="n">lag_terp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                         <span class="p">)</span>

    <span class="k">return</span> <span class="n">lags</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="litmus.fitting_methods.hessian_scan.diagnostics" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="n">diagnostics</span><span class="p">(</span><span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Runs some diagnostics for convergence</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
            </td>
            <td>
              <div class="doc-md-description">
                
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">diagnostics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Runs some diagnostics for convergence</span>
<span class="sd">    :return:</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_evidences_uncert</span>

    <span class="n">lagplot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_peaks</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">]</span>
    <span class="n">I</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scan_peaks</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
    <span class="n">lagplot</span> <span class="o">=</span> <span class="n">lagplot</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">estmap_tol</span><span class="p">[</span><span class="n">I</span><span class="p">]</span>

    <span class="c1"># ---------</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Loss Norm, $ </span><span class="se">\\</span><span class="s2">vert \Delta x / \sigma_x </span><span class="se">\\</span><span class="s2">vert$&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Scan Lag No.&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lagplot</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Scan Losses&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">estmap_params</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">],</span> <span class="n">Y</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Initial MAP Scan Loss&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">opt_tol</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Nominal Tolerance Limit&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">.5</span><span class="p">,</span> <span class="mf">.05</span><span class="p">,</span> <span class="s2">&quot;How far each optimization slice is from its peak. Lower is good.&quot;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="litmus.fitting_methods.SVI_scan" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">SVI_scan</span><span class="p">(</span><span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span> <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="              hessian_scan(stat_model: stats_model, out_stream=sys.stdout, err_stream=sys.stderr, verbose=True, debug=False, **fit_params) (litmus.fitting_methods.hessian_scan)" href="#litmus.fitting_methods.hessian_scan">hessian_scan</a></code></p>


        <p>An alternative to hessian_scan that fits each slice with stochastic variational
inference instead of the laplace approximation. Typically slower, but more robust against numerical failure in
low SNR signals and gives more accurate evidence estimates.</p>







                  <details class="quote">
                    <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span>
             <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>
             <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>
    <span class="n">args_in</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="nb">locals</span><span class="p">(),</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">}</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;__class__&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_default_params&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">|=</span> <span class="p">{</span>
        <span class="s1">&#39;ELBO_threshold&#39;</span><span class="p">:</span> <span class="mf">100.0</span><span class="p">,</span>
        <span class="s1">&#39;ELBO_optimstep&#39;</span><span class="p">:</span> <span class="mf">5E-3</span><span class="p">,</span>
        <span class="s1">&#39;ELBO_particles&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
        <span class="s1">&#39;ELBO_Nsteps&#39;</span><span class="p">:</span> <span class="mi">128</span><span class="p">,</span>
        <span class="s1">&#39;ELBO_Nsteps_init&#39;</span><span class="p">:</span> <span class="mi">1_000</span><span class="p">,</span>
        <span class="s1">&#39;ELBO_fraction&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">args_in</span><span class="p">)</span>

    <span class="c1"># -----------------------------</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;SVI Scan Fitting Procedure&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">diagnostic_losses</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">diagnostic_loss_init</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">diagnostic_ints</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="litmus.fitting_methods.JAVELIKE" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>              <code class="highlight language-python"><span class="n">JAVELIKE</span><span class="p">(</span><span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span> <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="              fitting_procedure(stat_model: stats_model, out_stream=sys.stdout, err_stream=sys.stderr, verbose=True, debug=True, **fit_params) (litmus.fitting_methods.fitting_procedure)" href="#litmus.fitting_methods.fitting_procedure">fitting_procedure</a></code></p>


        <p>A direct MCMC implementation using the AEIS in the style of JAVELIN
Note that, because NumPyro fits in the unconstrained domain while JAVELIN fits in the constrained domain,
the behaviour of the two will be slightly different near the prior boundaries.</p>
<p>Note that this is for example / comparison only, and <em>should not be used for actual fitting</em> as it cannot handle
the multimodal distributions of seasonal lightcurves</p>







                  <details class="quote">
                    <summary>Source code in <code>litmus/fitting_methods.py</code></summary>
                    <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stat_model</span><span class="p">:</span> <span class="n">stats_model</span><span class="p">,</span>
             <span class="n">out_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">,</span> <span class="n">err_stream</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">,</span>
             <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">):</span>
    <span class="n">args_in</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="nb">locals</span><span class="p">(),</span> <span class="o">**</span><span class="n">fit_params</span><span class="p">}</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;__class__&#39;</span><span class="p">]</span>
    <span class="k">del</span> <span class="n">args_in</span><span class="p">[</span><span class="s1">&#39;fit_params&#39;</span><span class="p">]</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_default_params&#39;</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_default_params</span> <span class="o">|=</span> <span class="p">{</span>
        <span class="s1">&#39;alpha&#39;</span><span class="p">:</span> <span class="mf">2.0</span><span class="p">,</span>
        <span class="s1">&#39;num_chains&#39;</span><span class="p">:</span> <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;num_samples&#39;</span><span class="p">:</span> <span class="mi">200_000</span> <span class="o">//</span> <span class="mi">256</span><span class="p">,</span>
        <span class="s1">&#39;num_warmup&#39;</span><span class="p">:</span> <span class="mi">5_000</span><span class="p">,</span>
    <span class="p">}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sampler</span><span class="p">:</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">infer</span><span class="o">.</span><span class="n">MCMC</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kernel</span><span class="p">:</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">infer</span><span class="o">.</span><span class="n">AEIS</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">limited_model</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">args_in</span><span class="p">)</span>

    <span class="c1"># -----------------------------</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;AEIS JAVELIN Emulator fitting Procedure&quot;</span>
</code></pre></div></td></tr></table></div>
                  </details>



  <div class="doc doc-children">











  </div>

    </div>

</div>




  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["search.suggest", "search.highlight", "search.tabs.link", "navigation.expand", "toc.follow", "navigation.tracking"], "search": "../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>